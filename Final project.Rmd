– Model selection and post-selection inference: In regression modeling, we sometimes want to include only a subset of our variables in the model and would like that decision to be data dependent. 
Two solutions to this problem are forward stepwise selection and backward stepwise selection, in which you fit a sequence of models, either adding or subtracting one variable at a time until some stopping criterion is reached. 
These procedures work for variable selection, but they invalidate the standard methods of inference in linear models. 
2 You will: 
– Write code implementing either forward stepwise selection or backward stepwise selection. 
 – Set up a simulation experiment, run your method on simulated data, obtain p-values or confidence intervals in the selected model.
----------------------------------


#data generating
-Set the model
```{r}
#simple setup: standard linear model Y=Xβ+ε. 

set.seed(610)

n <- 100
p <- 10 

X <- matrix(rnorm(n*p), n, p)
beta <- c(1, -1, rep(0, p-2))
e <- rnorm(n)
y <- X %*% beta + e  
```


#implement stepwise: backward stepwise selection 
-add or remove one variable at a time 
```{r}
#approach: remove one predictor at a time based on the smallest RSS

#Prepare data 
dat <- data.frame(y = as.numeric(y), X)
colnames(dat) <- c("y", paste0("X", 1:p))

full_model <- lm(y ~ ., data = dat)

#Create a structure to store results 

cols <- names(dat)
pred <- cols[cols != "y"]

model_list <- list() 

while (TRUE) {
  k <- length(pred)
  
  fm <- paste(pred, collapse = "+")
  form <- as.formula(paste("y ~ ", fm))
  
  fit <- lm(form, dat)
  rss_vec <- numeric(k)
  
  for (i in 1:k) {
    nw_vec <- pred[-i]
    nw_fm <- paste(nw_vec, collapse = "+")
    nw_form <- as.formula(paste("y ~ ", nw_fm))
    nw_fit <- lm(nw_form, dat)
    rss_vec[i] <- sum((nw_fit$residuals)^2)
  }
  
  min_rss <- which.min(rss_vec)
  pred <- pred[-(min_rss)]
  
  break
}


  ---------------------------------------------Not yet 
  
  
  if (k == 0) {
    break
  }




```


git init

#Simulation with the final model
```{r}
#how complex the code should be 

#1. apply generate data & stepwise selection code 
#2. implement simulation code 
#3. obtain p-values or confidence interval

simulation <- 1000

for (i in 1:simulation) {
X <- matrix(rnorm(n*p), n, p)
beta <- c(1, -1, rep(0, p-2))
e <- rnorm(n)
y <- X %*% beta + e  
}

backward_stepwise

```

#Summarize and interpret results
